<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anonymous Message Drop</title>
  <meta name="description" content="Drop an anonymous message that gets forwarded to Discord. Totally not secure. Have fun." />
  <style>
    :root{
      --bg1:#2196f3;
      --bg2:#e3f2fd;
      --fg:#333;
      --card:#fff;
      --muted:#6b7280;
      --primary:#2196f3;
      --ok:#22c55e;
      --shadow:0 8px 24px rgba(0,0,0,.12);
      --radius:14px;
    }

    *{box-sizing:border-box}

    body {
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(120deg, var(--bg1), var(--bg2));
      color: var(--fg);
      min-height:100dvh;
      margin:0;
      display:grid;
      place-items:center;
      padding: 40px 16px;
    }

    .container {
      background: var(--card);
      border-radius: var(--radius);
      padding: 24px;
      width: 100%;
      max-width: 480px;
      box-shadow: var(--shadow);
    }

    h1 {
      font-size: 22px;
      margin: 0 0 12px;
    }

    p.lead {
      margin: 0 0 16px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.5;
    }

    form {
      display: grid;
      gap: 12px;
      margin-top: 8px;
    }

    label {
      font-size: 14px;
      display:block;
      text-align:left;
      color:#111827;
    }

    textarea {
      width: 100%;
      height: 140px;
      padding: 12px;
      border: 1px solid #d1d5db;
      border-radius: 10px;
      resize: vertical;
      font: inherit;
    }

    .row {
      display:flex;
      align-items:center;
      gap:8px;
      justify-content:flex-start;
      text-align:left;
    }

    .row input[type="checkbox"]{
      width:18px;
      height:18px;
      accent-color: var(--primary);
      cursor:pointer;
    }

    .help {
      font-size: 12px;
      color: var(--muted);
    }

    button {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
    }

    button[disabled] {
      background-color: #c7cdd4;
      cursor: not-allowed;
    }

    .footnote {
      font-size: 12px;
      color: var(--muted);
      margin-top: 10px;
      text-align:left;
    }

    /* Fullscreen success modal */
    #successModal {
      position: fixed;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.85);
      display: none;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 18px;
      z-index: 9999;
      flex-direction: column;
      padding: 24px;
      text-align:center;
    }
    #successModal .box{
      background:#0b1220;
      border:1px solid rgba(255,255,255,.08);
      border-radius: 14px;
      padding: 18px 22px;
      max-width: 520px;
      box-shadow: 0 20px 50px rgba(0,0,0,.35);
    }
    #successModal button {
      margin-top: 16px;
      padding: 10px 18px;
      font-size: 16px;
      background: var(--ok);
      border: none;
      border-radius: 10px;
      cursor: pointer;
      color:#04110a;
      font-weight:600;
    }

    .source-link {
      position: fixed;
      bottom: 12px;
      right: 12px;
      background: #f3f4f6;
      padding: 10px 14px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      font-size: 13px;
      color: var(--primary);
      cursor: pointer;
      font-weight: 600;
      text-decoration: none;
    }
    .source-link:hover { background: #e5e7eb; }
  </style>
</head>
<body>
  <main id="app" class="container" aria-live="polite" aria-busy="true">
    <!-- Rendered by JS -->
  </main>

  <!-- Success Modal -->
  <div id="successModal" role="dialog" aria-modal="true" aria-labelledby="successTitle">
    <div class="box">
      <div id="successTitle">✅ Message sent!</div>
      <div style="opacity:.85;margin-top:4px">It yeeted into Discord. Nice.</div>
      <button type="button" id="okButton">OK</button>
    </div>
  </div>

  <a class="source-link" href="https://github.com/Chin-x1919/anonymous_q-a" target="_blank" rel="noopener noreferrer">Source on GitHub →</a>

  <script>
    // ===== Configuration =====
    // NOTE: Secrets in client-side code are visible. This is a toy. Don't use for real secrets.
    const ChinXD1919 = "CF-Space00001";            // change this
    const https://discord.com/api/webhooks/1370093081818431508/u1vzomxdqwGknoG4-C2yIVupFi45rQgS8wY81XNT_Nb32mbW8kg0P8Qwd6RCIANDVJM_ = "YOUR_DISCORD_WEBHOOK";  // change this

    // ===== Utilities =====
    const qs = new URLSearchParams(window.location.search);
    const getKey = () => qs.get("key") || qs.get("Key") || qs.get("KEY");
    const el = (sel) => document.querySelector(sel);
    const clamp = (n, min, max) => Math.min(Math.max(n, min), max);

    // Very light local rate limit to avoid spam refresh (client-side only, easily bypassed)
    function rateLimited(ms = 4000){
      const now = Date.now();
      const last = Number(localStorage.getItem("last_send_ts") || 0);
      if (now - last < ms) return true;
      localStorage.setItem("last_send_ts", String(now));
      return false;
    }

    function renderApp(){
      const token = (getKey() || "").trim();
      if (token !== SECRET_KEY) {
        // Invalid key → show nothing to casuals (fake security™)
        document.body.innerHTML = "";
        return;
      }

      const app = el("#app");
      app.setAttribute("aria-busy", "false");
      app.innerHTML = `
        <h1>Anonymous Message Drop</h1>
        <p class="lead">Send a message to my Discord. Super serious anti-bot check included. (It's a checkbox.)</p>

        <form id="sendForm" novalidate>
          <label for="msg">Your message</label>
          <textarea id="msg" name="msg" placeholder="Type your confession, roast, or secret here..." maxlength="800" required aria-required="true"></textarea>
          <div class="help">Max ~800 chars. Keep it civil, internet person.</div>

          <div class="row">
            <input type="checkbox" id="humanCheck" />
            <label for="humanCheck" class="help" style="margin:0">I am not a bot (I can check a box).</label>
          </div>

          <button id="submitButton" type="submit" disabled>Send it</button>
        </form>

        <p class="footnote">Only people with the link can access this page. That's our very advanced security layer™.</p>
      `;

      const form = el("#sendForm");
      const msgEl = el("#msg");
      const humanEl = el("#humanCheck");
      const button = el("#submitButton");

      humanEl.addEventListener("change", () => {
        button.disabled = !humanEl.checked;
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        if (!humanEl.checked) {
          alert("Please confirm you are human first.");
          return;
        }

        let msg = (msgEl.value || "").trim();
        if (!msg) return;

        // extra tiny sanitation/normalization
        msg = msg.replace(/\s+/g, " ");
        msg = msg.slice(0, 800); // hard cap
        if (rateLimited(3500)) {
          alert("Slow down, turbo. Try again in a few seconds.");
          return;
        }

        try {
          const res = await fetch(DISCORD_WEBHOOK, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ content: msg })
          });

          if (!res.ok) {
            console.warn("Discord responded with non-OK status:", res.status);
          }
        } catch (err) {
          console.error("Failed to call webhook:", err);
        }

        form.reset();
        button.disabled = true;
        showModal();
      });
    }

    // ===== Modal Controls =====
    function showModal() {
      const modal = el("#successModal");
      modal.style.display = "flex";
      el("#okButton").focus();
    }
    function hideModal() {
      el("#successModal").style.display = "none";
    }
    document.addEventListener("click", (e) => {
      if (e.target && e.target.id === "okButton") hideModal();
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") hideModal();
    });

    // ===== Boot =====
    renderApp();
  </script>
</body>
</html>
